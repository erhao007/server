import{d as x,r as m,a as f,c as _,e as a,w as o,f as t,h as w,p as P,i as k,t as C,b as c,g as I,u as N,_ as U}from"./index-Cun3tfJB.js";const B={class:"install-container"},E={key:0,class:"error-msg"},M=x({__name:"Install",setup(R){const g=N(),u=m(),n=m(!1),d=m(""),s=f({username:"admin",password:"",confirmPassword:""}),v=f({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,message:"长度在 3 个字符以上",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:5,message:"长度在 5 个字符以上",trigger:"blur"}],confirmPassword:[{validator:(p,e,r)=>{e===""?r(new Error("请再次输入密码")):e!==s.password?r(new Error("两次输入密码不一致!")):r()},trigger:"blur"}]}),V=async()=>{u.value&&await u.value.validate(async p=>{if(p){n.value=!0,d.value="";try{await I.install(s.username,s.password),n.value=!1,g.push("/login")}catch(e){n.value=!1,d.value=e.response?.data?.error||"初始化失败，请重试"}}})};return(p,e)=>{const r=t("el-input"),i=t("el-form-item"),b=t("el-button"),y=t("el-form"),h=t("el-card");return w(),_("div",B,[a(h,{class:"install-card"},{header:o(()=>[...e[3]||(e[3]=[c("div",{class:"card-header"},[c("h2",null,"Mochi MQTT 初始化"),c("p",{class:"subtitle"},"创建超级管理员账户")],-1)])]),default:o(()=>[a(y,{model:s,rules:v,ref_key:"formRef",ref:u,"label-width":"80px","label-position":"top"},{default:o(()=>[a(i,{label:"管理员用户名",prop:"username"},{default:o(()=>[a(r,{modelValue:s.username,"onUpdate:modelValue":e[0]||(e[0]=l=>s.username=l),placeholder:"请输入用户名","prefix-icon":"User"},null,8,["modelValue"])]),_:1}),a(i,{label:"管理员密码",prop:"password"},{default:o(()=>[a(r,{modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=l=>s.password=l),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),a(i,{label:"确认密码",prop:"confirmPassword"},{default:o(()=>[a(r,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>s.confirmPassword=l),type:"password",placeholder:"请再次输入密码","prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),a(i,null,{default:o(()=>[a(b,{type:"primary",loading:n.value,onClick:V,style:{width:"100%"}},{default:o(()=>[...e[4]||(e[4]=[k(" 完成初始化 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),d.value?(w(),_("div",E,C(d.value),1)):P("",!0)]),_:1})])}}}),L=U(M,[["__scopeId","data-v-05c37fe0"]]);export{L as default};
