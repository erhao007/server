import{d as C,r as k,a as B,o as D,c as L,b as i,e,w as a,f as o,g as u,E as d,h as E,i as w,j as I}from"./index-BAVvkMCM.js";const U=C({__name:"Listeners",setup(T){const m=k([]),l=B({type:"tcp",id:"",address:""}),c=async()=>{try{const s=await u.getListeners();m.value=s.data}catch(s){d.error("获取端口列表失败: "+s.message)}},g=async()=>{if(!l.id||!l.address){d.warning("ID 和地址是必填项");return}try{await u.addListener(l.type,l.id,l.address),d.success("监听端口已添加"),l.id="",l.address="",c()}catch(s){d.error("添加失败: "+s.message)}},V=s=>{I.confirm("确定要停止该监听端口吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await u.deleteListener(s),d.success("监听端口已停止"),c()}catch(t){d.error("停止失败: "+t.message)}}).catch(()=>{})};return D(()=>{c()}),(s,t)=>{const _=o("el-option"),x=o("el-select"),p=o("el-form-item"),f=o("el-input"),b=o("el-button"),v=o("el-form"),y=o("el-card"),r=o("el-table-column"),h=o("el-table");return E(),L("div",null,[t[7]||(t[7]=i("h2",null,"端口管理",-1)),e(y,{class:"box-card",style:{"margin-bottom":"20px"}},{header:a(()=>[...t[3]||(t[3]=[i("div",{class:"card-header"},[i("span",null,"添加监听端口")],-1)])]),default:a(()=>[e(v,{inline:!0,model:l,class:"demo-form-inline"},{default:a(()=>[e(p,{label:"类型"},{default:a(()=>[e(x,{modelValue:l.type,"onUpdate:modelValue":t[0]||(t[0]=n=>l.type=n),placeholder:"选择类型"},{default:a(()=>[e(_,{label:"TCP",value:"tcp"}),e(_,{label:"Websocket",value:"ws"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"ID"},{default:a(()=>[e(f,{modelValue:l.id,"onUpdate:modelValue":t[1]||(t[1]=n=>l.id=n),placeholder:"ID (例如: t2)"},null,8,["modelValue"])]),_:1}),e(p,{label:"地址"},{default:a(()=>[e(f,{modelValue:l.address,"onUpdate:modelValue":t[2]||(t[2]=n=>l.address=n),placeholder:"地址 (例如: :1884)"},null,8,["modelValue"])]),_:1}),e(p,null,{default:a(()=>[e(b,{type:"primary",onClick:g},{default:a(()=>[...t[4]||(t[4]=[w("添加",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(y,{class:"box-card"},{header:a(()=>[...t[5]||(t[5]=[i("div",{class:"card-header"},[i("span",null,"活跃端口")],-1)])]),default:a(()=>[e(h,{data:m.value,style:{width:"100%"}},{default:a(()=>[e(r,{prop:"id",label:"ID",width:"180"}),e(r,{prop:"type",label:"类型",width:"180"}),e(r,{prop:"address",label:"监听地址"}),e(r,{prop:"protocol",label:"协议"}),e(r,{fixed:"right",label:"操作",width:"120"},{default:a(n=>[e(b,{type:"danger",size:"small",onClick:M=>V(n.row.id)},{default:a(()=>[...t[6]||(t[6]=[w("停止",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}});export{U as default};
